{
    "collab_server" : "",
    "contents" : "##########\n###???###\n##########\n\n## install packages\n\nlibrary(dplyr)\nlibrary(lubridate)\n\n## read data\ntest<-read.csv(file.choose(), stringsAsFactors=FALSE)\nstr(test)\ntest$message[1:10]\n\n# time data transformation\ntest$trans_time = as.POSIXct(test$update_time, tz=\"Asia/Taipei\", format = \"%Y-%m-%dT%H:%M:%S\")\ntest$trans_time_year = year(test$trans_time)\ntest$trans_time_month = month(test$trans_time)\ntest$trans_time_weekday = wday(test$trans_time)\nmax(test$trans_time)\nmin(test$trans_time)\n\n## hist of post frequency\nlength(test$author)\nlength(unique(test$author))\npost_table = as.data.frame(table(test$author,dnn = \"author\"))\nsort(post_table[,2])\n\nhist(post_table$Freq,\n     breaks = c(1:max(post_table[,2])),\n     main = \"Histogram of post\",\n     xlab = \"Frequency in about 5 month\")\n\n## subset by post frequency\n#one_post = duplicated(test$author)\n#test_duration = which(post_table[,2]>=2)\njoin_freq_table = left_join(test, post_table, by =\"author\")\nstr(join_freq_table)\n#merge(test, post_table, by = \"author\")\none_post_table = subset(join_freq_table, join_freq_table$Freq==1)\ntwo_or_more_posts_table = subset(join_freq_table, join_freq_table$Freq>=2)\nsummary(join_freq_table)\nsummary(one_post_table)\nsummary(two_or_more_posts_table)\n\n ## barplot of post and time\njoin_year_table = table(join_freq_table$trans_time_year)\njoin_month_table = table(join_freq_table$trans_time_month)\njoin_weekday_table = table(join_freq_table$trans_time_weekday)\none_year_table = table(one_post_table$trans_time_year)\none_month_table = table(one_post_table$trans_time_month)\none_weekday_table = table(one_post_table$trans_time_weekday)\ntwo_or_more_year_table = table(two_or_more_posts_table$trans_time_year)\ntwo_or_more_month_table = table(two_or_more_posts_table$trans_time_month)\ntwo_or_more_weekday_table = table(two_or_more_posts_table$trans_time_weekday)\n\npar(mfcol = c(3,3),mar=c(2,2,2,2))\nbarplot(join_year_table, col = \"yellow\", border = \"grey\", main = \"all_year\")\nbarplot(join_month_table, col = \"yellow\", border = \"grey\", main = \"all_month\")\nbarplot(join_weekday_table, col = \"yellow\", border = \"grey\", main = \"all_weekday\")\nbarplot(one_year_table, col = \"lightblue\", border = \"grey\", main = \"one_year\")\nbarplot(one_month_table, col = \"lightblue\", border = \"grey\", main = \"one_month\")\nbarplot(one_weekday_table, col = \"lightblue\", border = \"grey\", main = \"one_weekday\")\nbarplot(two_or_more_year_table, col = \"pink\", border = \"grey\", main = \"more_year\")\nbarplot(two_or_more_month_table, col = \"pink\", border = \"grey\", main = \"more_month\")\nbarplot(two_or_more_weekday_table, col = \"pink\", border = \"grey\", main = \"more_weekday\")\n\n## distribution and proportion of LIKES\npar(mfcol = c(3,1),mar=c(2,2,2,2))\nhist(test$likes, col = \"yellow\", border = \"grey\", main = \"all_likes\")\nhist(one_post_table$likes, col = \"lightblue\", border = \"grey\", main = \"one_likes\")\nhist(two_or_more_posts_table$likes, col = \"pink\", border = \"grey\", main = \"more_likes\")\n\njoin_p_likes_table = table(join_freq_table$likes)/sum(join_freq_table$likes)\none_p_likes_table = table(one_post_table$likes)/sum(one_post_table$likes)\ntwo_or_more_p_likes_table = table(two_or_more_posts_table$likes)/sum(two_or_more_posts_table$likes)\npar(mfcol = c(3,1),mar=c(0.5,0.5,0.5,0.5))\npie(join_p_likes_table, col = \"yellow\", border = \"black\", main = \"all_p_likes\")\npie(one_p_likes_table, col = \"lightblue\", border = \"black\", main = \"one_p_likes\")\npie(two_or_more_p_likes_table, col = \"pink\", border = \"black\",main = \"more_p_likes\")\nas.data.frame(join_p_likes_table)\nas.data.frame(one_p_likes_table)\nas.data.frame(two_or_more_p_likes_table)\n\n## subset by time\nyear2014_table = subset(join_freq_table, join_freq_table$trans_time_year==2014)\nyear2015_table = subset(join_freq_table, join_freq_table$trans_time_year==2015)\nyear2016_table = subset(join_freq_table, join_freq_table$trans_time_year==2016)\nyear2017_table = subset(join_freq_table, join_freq_table$trans_time_year==2017)\n\n## duration between posts\n\nlibrary(dplyr)\njoin_freq_duration_table = join_freq_table %>% arrange(author, trans_time) %>% group_by(author) %>% \n  mutate(timediff=c(NA,tail(trans_time,length(trans_time)-1)-head(trans_time,length(trans_time)-1)))\n\n\nlibrary(dplyr)\njoin_freq_duration_table = join_freq_table %>% arrange(author, trans_time) %>% group_by(author) %>% \n  mutate(timediff=c(NA,tail(trans_time,length(trans_time)-1)-head(trans_time,length(trans_time)-1)))\n",
    "created" : 1503956190316.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2987428140",
    "id" : "F01D6099",
    "lastKnownWriteTime" : 1504196191,
    "last_content_update" : -2147483648,
    "path" : "~/GitHub/R/Patient behavior/word analysis/1/TM_time_preprocessing.R",
    "project_path" : "TM_time_preprocessing.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}